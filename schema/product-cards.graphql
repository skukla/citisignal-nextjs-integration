# Product Cards Query Schema
#
# Types and query for product listing/category pages
# Supports both Catalog Service and Live Search
# Facets are handled by separate Citisignal_productFacets query

# Shared types used by product cards
type Citisignal_ColorOption {
  name: String
  hex: String
}

type Citisignal_ProductImage {
  url: String
  altText: String
}

# Product card type for listing pages
type Citisignal_ProductCard {
  id: String!
  sku: String!
  urlKey: String!
  name: String!
  manufacturer: String
  price: String!
  originalPrice: String
  discountPercent: Int
  inStock: Boolean!
  image: Citisignal_ProductImage     
  memory: [String]   
  colors: [Citisignal_ColorOption]
}

# Page info for pagination
type Citisignal_PageInfo {
  current_page: Int!
  page_size: Int!
  total_pages: Int!
}

# Product search result with pagination
type Citisignal_ProductCardResult {
  items: [Citisignal_ProductCard]
  totalCount: Int
  hasMoreItems: Boolean!
  currentPage: Int
  page_info: Citisignal_PageInfo
  facets: [Citisignal_Facet]  # Only populated on page 1 to reduce duplication
  aggregations: [Citisignal_Facet]  # Alias for facets to match frontend expectations
  _debug: String  # Debug information when requested
}

# Filter input for product searches (includes category for standalone queries)
input Citisignal_ProductFilter {
  category: String
  manufacturer: String
  memory: [String]
  colors: [String]
  priceMin: Float
  priceMax: Float
  onSaleOnly: Boolean
}

# Filter input for page-level queries (category comes from resolver parameter)
input Citisignal_PageFilter {
  manufacturer: String
  memory: [String]
  colors: [String]
  priceMin: Float
  priceMax: Float
  onSaleOnly: Boolean
}

# Sort direction enum
enum Citisignal_SortDirection {
  ASC
  DESC
}

# Sort attribute enum for product listings
enum Citisignal_ProductSortAttribute {
  RELEVANCE     # Default for search results
  PRICE         # Sort by price
  NAME          # Sort by product name
}

# Sort options
input Citisignal_SortInput {
  attribute: Citisignal_ProductSortAttribute!
  direction: Citisignal_SortDirection!
}

# Product cards query
extend type Query {
  Citisignal_productCards(
    phrase: String
    filter: Citisignal_ProductFilter
    limit: Int = 20
    page: Int = 1
    sort: Citisignal_SortInput
  ): Citisignal_ProductCardResult
}